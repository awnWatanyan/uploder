<div th:fragment="content">

  <div class="mb-4">
    <h2 class="fw-bold mb-0">Clients</h2>
  </div>

  <!-- Table Card -->
  <div class="card shadow-sm border-0">
    <div class="card-body pb-0">
      <div class="d-flex align-items-center justify-content-between flex-wrap gap-2">
        <h5 class="fw-semibold mb-0">All Clients</h5>

        <button class="btn btn-dark" type="button" data-coreui-toggle="modal" data-coreui-target="#modalAdd">
          <i class="fa-solid fa-plus me-2"></i>Add Client
        </button>
      </div>
      <!-- DataTables will inject its own search box and page length controls here -->
    </div>

    <div class="card-body p-3 pt-3">
      <div class="table-responsive">
        <table class="table table-bordered table-hover align-middle mb-0" id="clientTable">
          <thead class="table-light">
            <tr>
              <th style="min-width: 120px;">Code</th>
              <th style="min-width: 140px;">Service</th>
              <th style="min-width: 220px;">Name (Thai)</th>
              <th style="min-width: 220px;">Name (Eng)</th>
              <th style="min-width: 140px;">Created by</th>
              <th style="min-width: 200px;">Created Date/Time</th>
              <th style="min-width: 140px;">Updated by</th>
              <th style="min-width: 200px;">Updated Date/Time</th>
              <th class="text-center" style="min-width: 140px;">Actions</th>
            </tr>
          </thead>
          <tbody id="clientTbody"><!-- filled by JS --></tbody>
        </table>
      </div>
    </div>

    <div class="card-body pt-2">
      <div class="text-muted">
        Total Rows: <span id="totalRows">0</span>
      </div>
    </div>
  </div>

  <!-- Add Modal -->
  <div class="modal fade" id="modalAdd" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow">
        <div class="modal-header">
          <h5 class="modal-title fw-semibold">Add New Client</h5>
          <button type="button" class="btn-close" data-coreui-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Code</label>
            <input id="addCode" type="text" class="form-control" placeholder="e.g. C001" maxlength="40">
            <div class="form-text">Code must be unique with service.</div>
          </div>

          <div class="mb-3">
            <label class="form-label">Service</label>
            <input id="addService" type="text" class="form-control" placeholder="e.g. PRMF" maxlength="80">
          </div>

          <div class="mb-3">
            <label class="form-label">Name (Thai)</label>
            <input id="addNameTh" type="text" class="form-control" placeholder="ชื่อภาษาไทย" maxlength="200">
          </div>

          <div class="mb-2">
            <label class="form-label">Name (Eng)</label>
            <input id="addNameEn" type="text" class="form-control" placeholder="English name" maxlength="200">
          </div>

          <div id="addError" class="alert alert-danger py-2 mt-3 d-none"></div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-outline-secondary" type="button" data-coreui-dismiss="modal">Cancel</button>
          <button id="btnAddConfirm" class="btn btn-dark" type="button">Add</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div class="modal fade" id="modalEdit" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow">
        <div class="modal-header">
          <h5 class="modal-title fw-semibold">Edit Client</h5>
          <button type="button" class="btn-close" data-coreui-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Code</label>
            <input id="editCode" type="text" class="form-control" readonly>
          </div>

          <div class="mb-3">
            <label class="form-label">Service</label>
            <input id="editService" type="text" class="form-control" maxlength="80">
          </div>

          <div class="mb-3">
            <label class="form-label">Name (Thai)</label>
            <input id="editNameTh" type="text" class="form-control" maxlength="200">
          </div>

          <div class="mb-2">
            <label class="form-label">Name (Eng)</label>
            <input id="editNameEn" type="text" class="form-control" maxlength="200">
          </div>

          <div id="editError" class="alert alert-danger py-2 mt-3 d-none"></div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-outline-secondary" type="button" data-coreui-dismiss="modal">Cancel</button>
          <button id="btnEditConfirm" class="btn btn-dark" type="button">Save</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirm Modal -->
  <div class="modal fade" id="modalDelete" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow">
        <div class="modal-header">
          <h5 class="modal-title fw-semibold">Confirm Delete</h5>
          <button type="button" class="btn-close" data-coreui-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <div class="mb-2">
            Do you want to delete client <span class="fw-semibold" id="delCode"></span> ?
          </div>
          <div class="text-medium-emphasis" id="delName"></div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-outline-secondary" type="button" data-coreui-dismiss="modal">Cancel</button>
          <button id="btnDeleteConfirm" class="btn btn-danger" type="button">
            <i class="fa-solid fa-trash me-2"></i>Delete
          </button>
        </div>
      </div>
    </div>
  </div>

  <style>
    .btn-icon {
      width: 38px;
      height: 38px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      border-radius: .5rem;
    }
  </style>

  <!-- (Optional) CSRF meta tags if Spring Security is enabled -->
  <!--
  <meta name="_csrf" th:content="${_csrf.token}">
  <meta name="_csrf_header" th:content="${_csrf.headerName}">
  -->

  <!-- JS -->
  <script th:src="@{/js/client.js}"></script>
</div>
