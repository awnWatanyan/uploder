<div th:fragment="content">

  <!-- Page Title -->
  <div class="mb-4">
    <h2 class="fw-bold">Import Excel</h2>
  </div>

  <!-- Upload Card -->
  <div class="card shadow-sm border-0">
    <div class="card-body">
      <h5 class="mb-3 fw-semibold">Upload Excel File (.xlsx)</h5>

      <div th:if="${uploadError}" class="alert alert-danger py-2" th:text="${uploadError}"></div>
      <div th:if="${saveMsg}" class="alert alert-success py-2" th:text="${saveMsg}"></div>

      <form method="post" enctype="multipart/form-data" th:action="@{/import-excel/upload}" style="justify-items: center;">
        <div class="d-flex align-items-center gap-3 flex-wrap">

          <label class="btn btn-dark mb-0">
            <i class="fa-solid fa-upload me-2"></i>
            Choose File
            <input type="file" name="file" hidden accept=".xlsx" onchange="this.form.submit()">
          </label>

          <a class="btn btn-outline-primary" th:href="@{/templates/import-template.xlsx}">
            <i class="fa-solid fa-download me-2"></i>
            Download Template
          </a>
        </div>
      </form>
    </div>
  </div>

  <!-- Imported Data Table -->
  <div class="card shadow-sm border-0 mt-4">
    <div class="card-body">
    
			<div class="d-flex align-items-center justify-content-between gap-3 mb-3 flex-wrap">
				<h5 class="fw-semibold mb-2">Data Preview</h5>
				<div class="text-muted">
					<i class="fa-regular fa-file-excel me-1"></i> <span
						th:text="${uploadedFileName} ?: 'No file uploaded'"></span>
				</div>
			</div>

			<div class="d-flex align-items-center justify-content-between gap-3 mb-3 flex-wrap">
				<div class="d-flex gap-2">
					<form method="post" th:action="@{/import-excel/save}" class="m-0">
						<button type="submit" class="btn btn-success"
							th:disabled="${rowCount == 0}">
							<i class="fa-solid fa-paper-plane me-2"></i>Save&Send
						</button>
					</form>

					<form method="post" th:action="@{/import-excel/save}" class="m-0">
						<button type="submit" class="btn btn-outline-warning"
							th:disabled="${rowCount == 0}">
							<i class="fa-solid fa-save me-2"></i>Save Only
						</button>
					</form>
				</div>
				
				<div class="d-flex gap-2">
					<form method="post" th:action="@{/import-excel/clear}" class="m-0">
						<button type="submit" class="btn btn-outline-secondary"
							th:disabled="${rowCount == 0}">
							<i class="fa-solid fa-broom me-2"></i>Clear
						</button>
					</form>
				</div>
			</div>

			<!-- Table -->
      <div class="table-responsive table-scroll" th:if="${rowCount > 0}">
        <table class="table table-bordered table-hover align-middle mb-0 table-wide">
          <thead class="table-light">
            <tr>
              <th class="sticky-col bg-light">#</th>
              <th th:each="h : ${headers}" th:text="${h}">Header</th>
            </tr>
          </thead>

          <tbody>
            <tr th:each="r, st : ${rows}">
              <td class="sticky-col bg-white" th:text="${st.index + 1}">1</td>
              <td th:each="v : ${r}" th:text="${v}">Data</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="text-muted text-center" th:if="${rowCount == 0}">
        No data to preview.
      </div>

      <!-- Row count -->
      <div class="mt-2 text-muted small" th:if="${rowCount > 0}">
        Total Rows: <span class="fw-semibold" th:text="${rowCount}">0</span>
      </div>

    </div>
  </div>

</div>
